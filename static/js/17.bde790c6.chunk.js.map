{"version":3,"sources":["components/DeleteAccount.tsx","components/services/Firebase.tsx","components/subComponents/Html.tsx"],"names":["DeleteAccount","useState","email","setEmail","password","setPassword","buttonStatus","setButtonStatus","error","setError","useEffect","Firebase","auth","signOut","title","className","onSubmit","e","preventDefault","btn","document","querySelector","setAttribute","signInWithEmailAndPassword","then","db","collection","doc","currentUser","uid","delete","storage","ref","child","listAll","res","images","items","i","length","console","log","window","location","href","catch","message","removeAttribute","type","required","placeholder","onChange","target","value","id","style","marginTop","fire","firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","firestore","Html","props"],"mappings":"gKAwFeA,UAnFf,WAA0B,IAAD,EACGC,mBAAS,IADZ,mBAChBC,EADgB,KACTC,EADS,OAESF,mBAAS,IAFlB,mBAEhBG,EAFgB,KAENC,EAFM,OAGiBJ,mBAAS,kBAH1B,mBAGhBK,EAHgB,KAGFC,EAHE,OAIGN,mBAAS,IAJZ,mBAIhBO,EAJgB,KAITC,EAJS,KAqDvB,OA/CAC,qBAAU,WACRC,IAASC,OAAOC,YACf,IA8CD,gCACE,cAAC,IAAD,CAAMC,MAAM,mCACZ,sBAAKC,UAAU,oBAAf,UACE,yHAKA,uBAAMC,SApDS,SAACC,GACpBA,EAAEC,iBACF,IAAIC,EAAMC,SAASC,cAAc,QAC9B,OAAHF,QAAG,IAAHA,KAAKG,aAAa,WAAY,IAC9Bf,EAAgB,cAChBI,IAASC,OACNW,2BAA2BrB,EAAOE,GAClCoB,MAAK,WAAO,IAAD,EACVC,IAAGC,WAAW,SACXC,IADH,UACOhB,IAASC,OAAOgB,mBADvB,aACO,EAA6BC,KACjCC,SACAN,MAAK,WAAO,IAAD,EAESb,IAASoB,UACzBC,MACAC,MAAM,oBAAWtB,IAASC,OAAOgB,mBAA3B,aAAW,EAA6BC,MAG9CK,UACAV,MAAK,SAACW,GAEL,IADA,IAAIC,EAASD,EAAIE,MACRC,EAAI,EAAGA,EAAIF,EAAOG,OAAQD,IACjCF,EAAOE,GAAGR,SAASN,MAAK,WACtBgB,QAAQC,IAAI,cAIjBjB,MAAK,WAAO,IAAD,EACV,UAAAb,IAASC,OACNgB,mBADH,SACgBE,SACbN,MAAK,WACJkB,OAAOC,SAASC,KAAO,uBAKpCC,OAAM,SAACrC,GACND,EAAgB,kBAChBE,EAASD,EAAMsC,SACZ,OAAH3B,QAAG,IAAHA,KAAK4B,gBAAgB,gBAarB,UACE,uBACEC,KAAK,QACLC,UAAQ,EACRC,YAAY,aACZC,SAAU,SAAClC,GAAD,OAAOd,EAASc,EAAEmC,OAAOC,UAErC,uBACEL,KAAK,WACLC,UAAQ,EACRC,YAAY,gBACZC,SAAU,SAAClC,GAAD,OAAOZ,EAAYY,EAAEmC,OAAOC,UAExC,wBAAQC,GAAG,MAAX,SAAkBhD,OAEpB,mBAAGiD,MAAO,CAAEC,UAAW,QAAvB,SAAkChD,Y,gCClF1C,8CAeMiD,GAfN,kBAeaC,IAASC,cAVC,CACrBC,OAAQ,0CACRC,WAAY,mCACZC,UAAW,mBACXC,cAAe,+BACfC,kBAAmB,eACnBC,MAAO,+CAKIxC,EAAKiC,IAASQ,YAEZT,O,gCClBf,mBAiBeU,IAff,SAAcC,GACV,OACI,eAAC,IAAD,WACQ,gCAAQA,EAAMtD,QACd","file":"static/js/17.bde790c6.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"../style/css/main.css\";\r\nimport Firebase, { db } from \"./services/Firebase\";\r\nimport HTML from \"./subComponents/Html\";\r\n\r\nfunction DeleteAccount() {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [buttonStatus, setButtonStatus] = useState(\"Delete account\");\r\n  const [error, setError] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    Firebase.auth().signOut();\r\n  }, []);\r\n\r\n  const handleDelete = (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    let btn = document.querySelector(\"#btn\") as HTMLButtonElement;\r\n    btn?.setAttribute(\"disabled\", \"\");\r\n    setButtonStatus(\"Loading...\");\r\n    Firebase.auth()\r\n      .signInWithEmailAndPassword(email, password)\r\n      .then(() => {\r\n        db.collection(\"users\")\r\n          .doc(Firebase.auth().currentUser?.uid)\r\n          .delete()\r\n          .then(() => {\r\n            // delete the storage files if he have one (profile image)\r\n            const storageRef = Firebase.storage()\r\n              .ref()\r\n              .child(`users/` + Firebase.auth().currentUser?.uid);\r\n\r\n            storageRef\r\n              .listAll()\r\n              .then((res) => {\r\n                let images = res.items;\r\n                for (let i = 0; i < images.length; i++) {\r\n                  images[i].delete().then(() => {\r\n                    console.log(\"done\");\r\n                  });\r\n                }\r\n              })\r\n              .then(() => {\r\n                Firebase.auth()\r\n                  .currentUser?.delete()\r\n                  .then(() => {\r\n                    window.location.href = \"/sign-up\";\r\n                  });\r\n              });\r\n          });\r\n      })\r\n      .catch((error) => {\r\n        setButtonStatus(\"Delete account\");\r\n        setError(error.message);\r\n        btn?.removeAttribute(\"disabled\");\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <HTML title=\"JustType - Delete your account\" />\r\n      <div className=\"deleteYourAccount\">\r\n        <p>\r\n          For security purposes you will need to re-enter your credentials to\r\n          delete your account.\r\n        </p>\r\n\r\n        <form onSubmit={handleDelete}>\r\n          <input\r\n            type=\"email\"\r\n            required\r\n            placeholder=\"Your email\"\r\n            onChange={(e) => setEmail(e.target.value)}\r\n          />\r\n          <input\r\n            type=\"password\"\r\n            required\r\n            placeholder=\"Your password\"\r\n            onChange={(e) => setPassword(e.target.value)}\r\n          />\r\n          <button id=\"btn\">{buttonStatus}</button>\r\n        </form>\r\n        <p style={{ marginTop: \"10px\" }}>{error}</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default DeleteAccount;\r\n","import firebase from \"firebase/app\";\r\nimport \"firebase/firestore\";\r\nimport \"firebase/storage\";\r\nimport \"firebase/auth\";\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyBPuJnN5gI3o_YZeVNlZwOky-7Y6LDGrTI\",\r\n  authDomain: \"justtype-preview.firebaseapp.com\",\r\n  projectId: \"justtype-preview\",\r\n  storageBucket: \"justtype-preview.appspot.com\",\r\n  messagingSenderId: \"648878251377\",\r\n  appId: \"1:648878251377:web:e42775dc14919b1475ead0\",\r\n};\r\n\r\n// Initialize Firebase\r\nconst fire = firebase.initializeApp(firebaseConfig);\r\nexport const db = firebase.firestore();\r\n\r\nexport default fire;\r\n","import Helmet from \"react-helmet\";\r\n\r\nfunction Html(props:any) {\r\n    return (\r\n        <Helmet>\r\n                <title>{props.title}</title>\r\n                <style>\r\n                {`\r\n                 body {\r\n                    background-color: #0e0b11;       \r\n                  }\r\n                `}\r\n                </style>\r\n        </Helmet>\r\n    )\r\n}\r\n\r\nexport default Html\r\n"],"sourceRoot":""}