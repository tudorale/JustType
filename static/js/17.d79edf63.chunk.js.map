{"version":3,"sources":["components/DeleteAccount.tsx","components/services/Firebase.tsx","components/subComponents/Html.tsx"],"names":["DeleteAccount","useState","email","setEmail","password","setPassword","buttonStatus","setButtonStatus","error","setError","history","useHistory","config","require","title","name","className","onSubmit","e","preventDefault","btn","document","querySelector","setAttribute","Firebase","auth","signInWithEmailAndPassword","then","db","collection","doc","currentUser","uid","delete","storage","ref","child","listAll","res","images","items","i","length","console","log","push","catch","message","removeAttribute","type","required","placeholder","onChange","target","value","id","style","marginTop","fire","firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","firestore","Html","props"],"mappings":"wKAwFeA,UAlFf,WAA0B,IAAD,EACGC,mBAAiB,IADpB,mBAChBC,EADgB,KACTC,EADS,OAESF,mBAAS,IAFlB,mBAEhBG,EAFgB,KAENC,EAFM,OAGiBJ,mBAAiB,kBAHlC,mBAGhBK,EAHgB,KAGFC,EAHE,OAIGN,mBAAiB,IAJpB,mBAIhBO,EAJgB,KAITC,EAJS,KAMjBC,EAAUC,cA8CVC,EAASC,EAAQ,IACvB,OACE,gCACE,cAAC,IAAD,CAAMC,MAAK,UAAKF,EAAOG,KAAZ,4BACX,sBAAKC,UAAU,oBAAf,UACE,mNAIA,uBAAMC,SArDS,SAACC,GACpBA,EAAEC,iBAEF,IAAIC,EAAMC,SAASC,cAAc,QAC9B,OAAHF,QAAG,IAAHA,KAAKG,aAAa,WAAY,IAC9BhB,EAAgB,cAEhBiB,IAASC,OACNC,2BAA2BxB,EAAOE,GAClCuB,MAAK,WAAO,IAAD,EACVC,IAAGC,WAAW,SACXC,IADH,UACON,IAASC,OAAOM,mBADvB,aACO,EAA6BC,KACjCC,SACAN,MAAK,WAAO,IAAD,EAESH,IAASU,UACzBC,MACAC,MAAM,oBAAWZ,IAASC,OAAOM,mBAA3B,aAAW,EAA6BC,MAG9CK,UACAV,MAAK,SAACW,GAEL,IADA,IAAIC,EAASD,EAAIE,MACRC,EAAI,EAAGA,EAAIF,EAAOG,OAAQD,IACjCF,EAAOE,GAAGR,SAASN,MAAK,WACtBgB,QAAQC,IAAI,cAIjBjB,MAAK,WAAO,IAAD,EACV,UAAAH,IAASC,OACNM,mBADH,SACgBE,SACbN,MAAK,WACJjB,EAAQmC,KAAK,wBAK1BC,OAAM,SAACtC,GACND,EAAgB,kBAChBE,EAASD,EAAMuC,SACZ,OAAH3B,QAAG,IAAHA,KAAK4B,gBAAgB,gBAYrB,UACE,uBACEC,KAAK,QACLC,UAAQ,EACRC,YAAY,aACZC,SAAU,SAAClC,GAAD,OAAOf,EAASe,EAAEmC,OAAOC,UAErC,uBACEL,KAAK,WACLC,UAAQ,EACRC,YAAY,gBACZC,SAAU,SAAClC,GAAD,OAAOb,EAAYa,EAAEmC,OAAOC,UAExC,wBAAQC,GAAG,MAAX,SAAkBjD,OAEpB,mBAAGkD,MAAO,CAAEC,UAAW,QAAvB,SAAkCjD,Y,6PClF1C,8CAeMkD,GAfN,kBAeaC,IAASC,cAVC,CACrBC,OAAQ,0CACRC,WAAY,mCACZC,UAAW,mBACXC,cAAe,+BACfC,kBAAmB,eACnBC,MAAO,+CAKItC,EAAK+B,IAASQ,YAEZT,O,gCClBf,mBAiBeU,IAff,SAAcC,GACZ,OACE,eAAC,IAAD,WACE,gCAAQA,EAAMvD,QACd","file":"static/js/17.d79edf63.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"../style/css/main.css\";\r\nimport Firebase, { db } from \"./services/Firebase\";\r\nimport HTML from \"./subComponents/Html\";\r\nimport {useHistory} from \"react-router-dom\";\r\n\r\nfunction DeleteAccount() {\r\n  const [email, setEmail] = useState<string>(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [buttonStatus, setButtonStatus] = useState<string>(\"Delete account\");\r\n  const [error, setError] = useState<string>(\"\");\r\n\r\n  const history = useHistory();\r\n\r\n  const handleDelete = (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n\r\n    let btn = document.querySelector(\"#btn\") as HTMLButtonElement;\r\n    btn?.setAttribute(\"disabled\", \"\");\r\n    setButtonStatus(\"Loading...\");\r\n\r\n    Firebase.auth()\r\n      .signInWithEmailAndPassword(email, password)\r\n      .then(() => {\r\n        db.collection(\"users\")\r\n          .doc(Firebase.auth().currentUser?.uid)\r\n          .delete()\r\n          .then(() => {\r\n            // delete the storage files if he have one (profile image)\r\n            const storageRef = Firebase.storage()\r\n              .ref()\r\n              .child(`users/` + Firebase.auth().currentUser?.uid);\r\n\r\n            storageRef\r\n              .listAll()\r\n              .then((res) => {\r\n                let images = res.items;\r\n                for (let i = 0; i < images.length; i++) {\r\n                  images[i].delete().then(() => {\r\n                    console.log(\"done\");\r\n                  });\r\n                }\r\n              })\r\n              .then(() => {\r\n                Firebase.auth()\r\n                  .currentUser?.delete()\r\n                  .then(() => {\r\n                    history.push(\"/sign-up\")\r\n                  });\r\n              });\r\n          });\r\n      })\r\n      .catch((error) => {\r\n        setButtonStatus(\"Delete account\");\r\n        setError(error.message);\r\n        btn?.removeAttribute(\"disabled\");\r\n      });\r\n  };\r\n  const config = require(\"../config.json\")\r\n  return (\r\n    <div>\r\n      <HTML title={`${config.name} | Delete your account`} />\r\n      <div className=\"deleteYourAccount\">\r\n        <p>\r\n          WARNING: This is the delete account page, enter your credentials from the account that you want to delete, after deleting your account you will be redirected to the Sign Up page.\r\n        </p>\r\n\r\n        <form onSubmit={handleDelete}>\r\n          <input\r\n            type=\"email\"\r\n            required\r\n            placeholder=\"Your email\"\r\n            onChange={(e) => setEmail(e.target.value)}\r\n          />\r\n          <input\r\n            type=\"password\"\r\n            required\r\n            placeholder=\"Your password\"\r\n            onChange={(e) => setPassword(e.target.value)}\r\n          />\r\n          <button id=\"btn\">{buttonStatus}</button>\r\n        </form>\r\n        <p style={{ marginTop: \"10px\" }}>{error}</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default DeleteAccount;\r\n","import firebase from \"firebase/app\";\r\nimport \"firebase/firestore\";\r\nimport \"firebase/storage\";\r\nimport \"firebase/auth\";\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyBPuJnN5gI3o_YZeVNlZwOky-7Y6LDGrTI\",\r\n  authDomain: \"justtype-preview.firebaseapp.com\",\r\n  projectId: \"justtype-preview\",\r\n  storageBucket: \"justtype-preview.appspot.com\",\r\n  messagingSenderId: \"648878251377\",\r\n  appId: \"1:648878251377:web:e42775dc14919b1475ead0\",\r\n};\r\n\r\n// Initialize Firebase\r\nconst fire = firebase.initializeApp(firebaseConfig);\r\nexport const db = firebase.firestore();\r\n\r\nexport default fire;\r\n","import Helmet from \"react-helmet\";\r\n\r\nfunction Html(props: any) {\r\n  return (\r\n    <Helmet>\r\n      <title>{props.title}</title>\r\n      <style>\r\n        {`\r\n                 body {\r\n                    background-color: #0b101b;       \r\n                  }\r\n                `}\r\n      </style>\r\n    </Helmet>\r\n  );\r\n}\r\n\r\nexport default Html;\r\n"],"sourceRoot":""}